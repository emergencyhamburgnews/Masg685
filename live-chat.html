<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#000000">
    <title>Live Chat - Masg685</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="myfavicon.jpg">
    <link rel="shortcut icon" type="image/jpeg" href="myfavicon.jpg">
    
    <!-- Social Media Meta Tags -->
    <meta property="og:title" content="Live Chat - Masg685">
    <meta property="og:description" content="Join the live chat and connect with other users!">
    <meta property="og:image" content="img4.jpg">
    <meta property="og:image:secure_url" content="img4.jpg">
    <meta property="og:image:type" content="image/jpeg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Live Chat - Masg685">
    <meta property="og:url" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Masg685">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Live Chat - Masg685">
    <meta name="twitter:description" content="Join the live chat and connect with other users!">
    <meta name="twitter:image" content="img4.jpg">
    <meta name="twitter:image:alt" content="Live Chat - Masg685">
    
    <!-- General Meta Tags -->
    <meta name="description" content="Join the live chat and connect with other users!">
    <meta name="keywords" content="masg685, live chat, group chat, social media, chat">
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        // Apply settings immediately to prevent white flash
        (function() {
            // Apply theme immediately
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            // Apply navbar color immediately
            const savedNavbarColor = localStorage.getItem('navbarColor') || 'black';
            document.documentElement.setAttribute('data-navbar-color', savedNavbarColor);
            
            // Apply glow color immediately
            const savedGlowColor = localStorage.getItem('glowColor') || 'blue';
            document.documentElement.setAttribute('data-glow-color', savedGlowColor);
            
            // Update theme color immediately
            let themeColor;
            switch (savedNavbarColor) {
                case 'red': themeColor = '#dc3545'; break;
                case 'blue': themeColor = '#007bff'; break;
                case 'green': themeColor = '#28a745'; break;
                case 'purple': themeColor = '#6f42c1'; break;
                case 'orange': themeColor = '#fd7e14'; break;
                case 'pink': themeColor = '#6c757d'; break;
                case 'cyan': themeColor = '#17a2b8'; break;
                case 'yellow': themeColor = '#ffc107'; break;
                default: themeColor = '#000000';
            }
            
            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            if (themeColorMeta) {
                themeColorMeta.setAttribute('content', themeColor);
            }
            
            // Prevent theme flash by setting body background immediately
            document.body.style.backgroundColor = savedTheme === 'dark' ? '#1a1a1a' : '#ffffff';
            document.body.style.color = savedTheme === 'dark' ? '#ffffff' : '#000000';
        })();
    </script>
</head>
<body>
    <!-- Live Chat Header -->
    <div class="chat-page-header">
        <button class="back-btn" onclick="goBack()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
        </button>
        <h1 class="chat-page-title">GROUP CHAT</h1>
        <div class="chat-page-actions">
            <button class="edit-btn" onclick="editProfile()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                </svg>
            </button>
            <button class="info-btn" onclick="showChatInfo()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                </svg>
            </button>
            <button id="chat-theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                <img id="chat-theme-icon" src="Dark Toggle icon.png" alt="Toggle theme">
            </button>
        </div>
    </div>

    <main class="chat-page-main">
        <!-- Live Chat Section -->
        <section class="live-chat-section">
            <!-- Chat Messages -->
            <div class="chat-messages" id="chat-messages">
                <!-- Messages will be loaded here -->
            </div>

            <!-- Message Input -->
            <div class="message-input-container">
                <input type="text" id="message-input" class="message-input" placeholder="Message......" maxlength="500">
                <input type="file" id="image-upload" class="image-upload-input" accept="image/*" style="display: none;">
                <button id="image-btn" class="image-btn" title="Upload Image">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                        <polyline points="21,15 16,10 5,21"></polyline>
                    </svg>
                </button>
                <button id="send-btn" class="send-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22,2 15,22 11,13 2,9 22,2"></polygon>
                    </svg>
                </button>
            </div>
        </section>
    </main>

    <!-- Notice Banner at bottom -->
    <div class="chat-notice-banner" id="chat-notice-banner">
        <span>Loading...</span>
    </div>

    <!-- Firebase CDN -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit, onSnapshot, doc, updateDoc, arrayUnion, arrayRemove, deleteDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA2MJ6qW7kKkXXR4xHkAb2uyWv-j5BIsAk",
            authDomain: "masgwebsite-4631e.firebaseapp.com",
            projectId: "masgwebsite-4631e",
            storageBucket: "masgwebsite-4631e.firebasestorage.app",
            messagingSenderId: "1093684867477",
            appId: "1:1093684867477:web:53f018205d2bb8b260469c"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // Make Firebase available globally
        window.firebaseApp = { db, auth, provider, collection, addDoc, getDocs, query, orderBy, limit, onSnapshot, doc, updateDoc, arrayUnion, arrayRemove, deleteDoc, signInWithPopup, signOut, onAuthStateChanged };
        
        // Test Firebase connection
        console.log('Firebase initialized:', app);
        console.log('Auth instance:', auth);
        console.log('Firestore instance:', db);
        console.log('Current domain:', window.location.hostname);
        console.log('Current origin:', window.location.origin);
    </script>
    
    <script src="script.js"></script>
    <script src="firebase-simple.js"></script>
    <script src="firebase-chat.js"></script>
    <script src="live-chat.js"></script>
    <script>
        // Theme toggle functionality for chat page
        document.addEventListener('DOMContentLoaded', function() {
            const themeToggle = document.getElementById('chat-theme-toggle');
            const themeIcon = document.getElementById('chat-theme-icon');
            
            if (themeToggle && themeIcon) {
                // Set initial theme icon
                updateThemeIcon();
                
                themeToggle.addEventListener('click', function() {
                    const currentTheme = document.documentElement.getAttribute('data-theme');
                    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                    
                    // Apply theme immediately
                    document.documentElement.setAttribute('data-theme', newTheme);
                    localStorage.setItem('theme', newTheme);
                    
                    // Update icon
                    updateThemeIcon();
                });
            }
            
            function updateThemeIcon() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                if (themeIcon) {
                    // In dark theme, show white icon. In light theme, show dark icon
                    themeIcon.src = currentTheme === 'dark' ? 'White Toggle icon.png' : 'Dark Toggle icon.png';
                    themeIcon.style.filter = 'none';
                    themeIcon.style.opacity = '1';
                }
            }
        });
    </script>
</body>
</html>
