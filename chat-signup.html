<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#000000">
    <title>Sign Up for Live Chat - Masg685</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="myfavicon.jpg">
    <link rel="shortcut icon" type="image/jpeg" href="myfavicon.jpg">
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        // Apply settings immediately to prevent white flash
        (function() {
            // Apply theme immediately
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            // Apply navbar color immediately
            const savedNavbarColor = localStorage.getItem('navbarColor') || 'black';
            document.documentElement.setAttribute('data-navbar-color', savedNavbarColor);
            
            // Apply glow color immediately
            const savedGlowColor = localStorage.getItem('glowColor') || 'blue';
            document.documentElement.setAttribute('data-glow-color', savedGlowColor);
            
            // Update theme color immediately
            let themeColor;
            switch (savedNavbarColor) {
                case 'red': themeColor = '#dc3545'; break;
                case 'blue': themeColor = '#007bff'; break;
                case 'green': themeColor = '#28a745'; break;
                case 'purple': themeColor = '#6f42c1'; break;
                case 'orange': themeColor = '#fd7e14'; break;
                case 'pink': themeColor = '#6c757d'; break;
                case 'cyan': themeColor = '#17a2b8'; break;
                case 'yellow': themeColor = '#ffc107'; break;
                default: themeColor = '#000000';
            }
            
            const themeColorMeta = document.querySelector('meta[name="theme-color"]');
            if (themeColorMeta) {
                themeColorMeta.setAttribute('content', themeColor);
            }
            
            // Prevent theme flash by setting body background immediately
            document.body.style.backgroundColor = savedTheme === 'dark' ? '#1a1a1a' : '#ffffff';
            document.body.style.color = savedTheme === 'dark' ? '#ffffff' : '#000000';
        })();
    </script>
</head>
<body>
    <!-- Sign Up Header -->
    <div class="signup-header">
        <button class="back-btn" onclick="goBack()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
        </button>
        <h1 class="signup-title">Edit Profile</h1>
        <div class="signup-header-actions">
            <button class="edit-btn" onclick="saveProfile()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                </svg>
            </button>
            <button id="signup-theme-toggle" class="theme-toggle" aria-label="Toggle theme">
                <img id="signup-theme-icon" src="Dark Toggle icon.png" alt="Toggle theme">
            </button>
        </div>
    </div>

    <main class="signup-main">
        <div class="signup-container">
            <!-- Profile Avatar -->
            <div class="profile-avatar-section">
                <div class="profile-avatar" id="profile-avatar">
                    <span class="avatar-initials" id="avatar-initials">NU</span>
                </div>
                <div class="profile-name" id="profile-name">Name User</div>
            </div>

            <!-- Name Input Fields -->
            <div class="name-inputs-section">
                <div class="input-group">
                    <label class="input-label">First name:</label>
                    <input type="text" id="first-name" class="name-input" placeholder="Name" maxlength="20">
                </div>
                <div class="input-group">
                    <label class="input-label">Last name:</label>
                    <input type="text" id="last-name" class="name-input" placeholder="User" maxlength="20">
                </div>
            </div>

            <!-- Profile Background Colour Selection -->
            <div class="color-selection-section">
                <h3 class="color-title">Profile Background Colour</h3>
                <div class="color-grid">
                    <div class="color-option" data-color="#FF6B6B" style="background-color: #FF6B6B;"></div>
                    <div class="color-option" data-color="#D3D3D3" style="background-color: #D3D3D3;"></div>
                    <div class="color-option" data-color="#9B59B6" style="background-color: #9B59B6;"></div>
                    <div class="color-option" data-color="#000000" style="background-color: #000000;"></div>
                    <div class="color-option" data-color="#FF8C00" style="background-color: #FF8C00;"></div>
                    <div class="color-option" data-color="#32CD32" style="background-color: #32CD32;"></div>
                    <div class="color-option" data-color="#8B4513" style="background-color: #8B4513;"></div>
                    <div class="color-option" data-color="#1E90FF" style="background-color: #1E90FF;"></div>
                    <div class="color-option" data-color="#00FF00" style="background-color: #00FF00;"></div>
                    <div class="color-option" data-color="#8B0000" style="background-color: #8B0000;"></div>
                </div>
            </div>

            <!-- Error Message -->
            <div class="error-message" id="error-message" style="display: none;"></div>

            <!-- Save Button -->
            <button class="save-profile-btn" onclick="saveProfile()">Save Profile</button>
        </div>
    </main>

    <!-- Firebase CDN -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit, onSnapshot, doc, updateDoc, arrayUnion, arrayRemove, deleteDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA2MJ6qW7kKkXXR4xHkAb2uyWv-j5BIsAk",
            authDomain: "masgwebsite-4631e.firebaseapp.com",
            projectId: "masgwebsite-4631e",
            storageBucket: "masgwebsite-4631e.firebasestorage.app",
            messagingSenderId: "1093684867477",
            appId: "1:1093684867477:web:53f018205d2bb8b260469c"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // Make Firebase available globally
        window.firebaseApp = { db, auth, provider, collection, addDoc, getDocs, query, orderBy, limit, onSnapshot, doc, updateDoc, arrayUnion, arrayRemove, deleteDoc, signInWithPopup, signOut, onAuthStateChanged };
        
        // Test Firebase connection
        console.log('Firebase initialized:', app);
        console.log('Auth instance:', auth);
        console.log('Firestore instance:', db);
        console.log('Current domain:', window.location.hostname);
        console.log('Current origin:', window.location.origin);
    </script>
    
    <script src="script.js"></script>
    <script src="firebase-simple.js"></script>
    <script src="firebase-chat.js"></script>
    <script src="chat-signup.js"></script>
    <script>
        // Theme toggle functionality for signup page
        document.addEventListener('DOMContentLoaded', function() {
            const themeToggle = document.getElementById('signup-theme-toggle');
            const themeIcon = document.getElementById('signup-theme-icon');
            
            if (themeToggle && themeIcon) {
                // Set initial theme icon
                updateThemeIcon();
                
                themeToggle.addEventListener('click', function() {
                    const currentTheme = document.documentElement.getAttribute('data-theme');
                    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                    
                    // Apply theme immediately
                    document.documentElement.setAttribute('data-theme', newTheme);
                    localStorage.setItem('theme', newTheme);
                    
                    // Update icon
                    updateThemeIcon();
                });
            }
            
            function updateThemeIcon() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                if (themeIcon) {
                    // In dark theme, show white icon. In light theme, show dark icon
                    themeIcon.src = currentTheme === 'dark' ? 'White Toggle icon.png' : 'Dark Toggle icon.png';
                    themeIcon.style.filter = 'none';
                    themeIcon.style.opacity = '1';
                }
            }
        });
    </script>
</body>
</html>
